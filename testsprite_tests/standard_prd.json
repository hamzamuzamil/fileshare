{
  "meta": {
    "project": "FilePizza",
    "date": "2025-11-19",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "FilePizza is a secure, peer-to-peer file transfer web application that enables users to share files directly between browsers using WebRTC technology without storing files on intermediary servers. It supports multiple file uploads, password protection, progress tracking, and works seamlessly across desktop and mobile browsers.",
  "core_goals": [
    "Enable fast and private peer-to-peer file transfers without intermediary servers.",
    "Provide a user-friendly interface with modern design and dark mode support.",
    "Allow uploaders to share files using links and QR codes with optional password protection.",
    "Support multiple simultaneous downloads and monitor transfer progress.",
    "Ensure secure and encrypted file transfer using WebRTC protocols.",
    "Support safe usage through terms acceptance and violation reporting.",
    "Handle large files efficiently, including multi-file uploads zipped for download."
  ],
  "key_features": [
    "File Upload via drag-and-drop or file picker supporting multiple files.",
    "Peer-to-peer File Download through WebRTC connections without server storage.",
    "WebRTC Connection Management with signaling and TURN/STUN support.",
    "File Uploader session management with QR code and shareable link generation.",
    "Optional Password Protection for upload sessions to restrict access.",
    "Progress Tracking for uploads and downloads with visual progress bars.",
    "Dark and Light Theme Management with easy toggling.",
    "Aurora animated background for enhanced UI aesthetics.",
    "Terms acceptance workflow and reports for terms violations.",
    "Backend API routes to manage connection channels and signaling.",
    "Streaming downloads using Web Streams API and Service Workers.",
    "Reusable UI Components with glassmorphism design for consistent style."
  ],
  "user_flow_summary": [
    "User visits the app and optionally toggles between light/dark mode.",
    "User initiates a file upload by drag-and-drop or file picker and selects multiple files if needed.",
    "The app generates a shareable link and a QR code representing the upload session.",
    "User optionally sets a password to protect the file transfer.",
    "User shares link or QR code with recipients.",
    "Recipients open the link and connect to the uploader's browser directly via WebRTC.",
    "Transferred files stream directly from uploader to downloader without server storage.",
    "Users monitor upload/download progress and can cancel or stop transfers.",
    "On completion, files are downloaded or received as zip if multiple files were shared.",
    "Users accept terms before transfer and can report violations if necessary."
  ],
  "validation_criteria": [
    "Files can be uploaded and downloaded successfully without intermediary server storage.",
    "Uploads support multiple files and provide a zipped download for recipients.",
    "File transfers handle connection failures gracefully and allow retry or cancel.",
    "Password protection restricts access to authorized downloaders only.",
    "Progress bars update accurately reflecting real-time upload/download status.",
    "Links and QR codes correctly identify and connect sessions between uploader and downloader.",
    "All WebRTC data channels and messaging use encrypted communication.",
    "UI is responsive and works across common desktop and mobile browsers.",
    "Theme toggle switches UI between dark and light modes without issues.",
    "Terms acceptance is required before transfers and violation reporting works.",
    "API endpoints for channel creation, renewal, and destruction function correctly under load.",
    "Background Aurora animation and UI components render smoothly without performance degradation."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js",
      "React",
      "WebRTC",
      "PeerJS",
      "Tailwind CSS",
      "Zod",
      "React Query",
      "Vitest",
      "Playwright"
    ],
    "features": [
      {
        "name": "File Upload",
        "description": "Allows users to upload files via drag-and-drop or file picker",
        "files": [
          "src/components/DropZone.tsx",
          "src/components/AddFilesButton.tsx",
          "src/app/page.tsx",
          "src/fs.ts"
        ]
      },
      {
        "name": "File Download",
        "description": "Enables peer-to-peer file downloads through WebRTC connections",
        "files": [
          "src/components/Downloader.tsx",
          "src/components/DownloadButton.tsx",
          "src/hooks/useDownloader.ts",
          "src/utils/download.ts",
          "src/app/download/[...slug]/page.tsx"
        ]
      },
      {
        "name": "WebRTC Connection Management",
        "description": "Manages peer-to-peer WebRTC connections for file transfer",
        "files": [
          "src/components/WebRTCProvider.tsx",
          "src/hooks/useUploaderChannel.ts",
          "src/hooks/useUploaderConnections.ts",
          "src/channel.ts"
        ]
      },
      {
        "name": "File Uploader",
        "description": "Handles file upload sessions with QR code and link sharing",
        "files": [
          "src/components/Uploader.tsx",
          "src/components/UploadFileList.tsx",
          "src/components/ConnectionListItem.tsx"
        ]
      },
      {
        "name": "Password Protection",
        "description": "Optional password protection for file transfers",
        "files": [
          "src/components/PasswordField.tsx",
          "src/components/UnlockButton.tsx"
        ]
      },
      {
        "name": "Link Sharing",
        "description": "Generates shareable links and QR codes for file transfers",
        "files": [
          "src/components/CopyableInput.tsx",
          "src/components/Uploader.tsx",
          "src/slugs.ts"
        ]
      },
      {
        "name": "Progress Tracking",
        "description": "Shows upload/download progress with progress bars",
        "files": [
          "src/components/ProgressBar.tsx",
          "src/components/ConnectionListItem.tsx"
        ]
      },
      {
        "name": "UI Components",
        "description": "Reusable UI components with glassmorphism design",
        "files": [
          "src/components/StartButton.tsx",
          "src/components/StopButton.tsx",
          "src/components/CancelButton.tsx",
          "src/components/Loading.tsx",
          "src/components/ErrorMessage.tsx",
          "src/components/TitleText.tsx",
          "src/components/SubtitleText.tsx",
          "src/components/Wordmark.tsx"
        ]
      },
      {
        "name": "Aurora Background",
        "description": "Animated Aurora background effect",
        "files": [
          "src/components/AuroraBackground.tsx",
          "src/styles.css"
        ]
      },
      {
        "name": "Theme Management",
        "description": "Dark/light theme switching",
        "files": [
          "src/components/ThemeProvider.tsx",
          "src/components/ModeToggle.tsx"
        ]
      },
      {
        "name": "Terms and Reporting",
        "description": "Terms acceptance and violation reporting",
        "files": [
          "src/components/TermsAcceptance.tsx",
          "src/components/ReportTermsViolationButton.tsx",
          "src/app/reported/page.tsx"
        ]
      },
      {
        "name": "API Routes",
        "description": "Backend API routes for channel management",
        "files": [
          "src/app/api/create/route.ts",
          "src/app/api/destroy/route.ts",
          "src/app/api/ice/route.ts",
          "src/app/api/renew/route.ts"
        ]
      },
      {
        "name": "File Streaming",
        "description": "Streams files for download using Web Streams API",
        "files": [
          "src/utils/download.ts",
          "src/zip-stream.ts"
        ]
      },
      {
        "name": "Message Protocol",
        "description": "Message encoding/decoding for WebRTC communication",
        "files": [
          "src/messages.ts"
        ]
      }
    ]
  }
}
